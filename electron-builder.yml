# electron-builder.yml (propuesta)

appId: com.starposai.lpa
productName: Starposai LPA

directories:
  output: dist
  buildResources: build

# Qué archivos entran al paquete (no uses asarUnpack para 'src/**')
files:
  - package.json
  - src/**            # tu app principal
  - ticket.html
  - scripts/**        # si los usas
  - "!node_modules/.cache/**"
  - "!**/*.map"

asar: true

# Solo desempaqueta módulos nativos. NO pongas 'src/**' aquí.
asarUnpack:
  - "node_modules/@serialport/**"
  - "node_modules/@serialport/bindings-cpp/**"
  - "node_modules/@serialport/bindings-interface/**"

# Publicación a GitHub
publish:
  - provider: github
    owner: IgorNSMD          # <— cámbialo si corresponde
    repo: starposai-lpa      # <— cámbialo si corresponde
    releaseType: release     # ← evita draft/pre-release
    vPrefixedTagName: false  # usa "1.1.0" en lugar de "v1.1.0" (o pon true y usa 'v')

# Windows / instalador
win:
  target:
    - nsis
  artifactName: "Starposai-LPA-Setup-${version}.exe"
  requestedExecutionLevel: asInvoker

nsis:
  oneClick: true
  perMachine: false
  allowElevation: true
  allowToChangeInstallationDirectory: false
  deleteAppDataOnUninstall: false

# Opcional: evita recompilar nativos si ya hiciste electron-rebuild en postinstall
npmRebuild: true
buildDependenciesFromSource: false

# Firma (si tienes cert) – opcional
# win:
#   certificateFile: path/to/cert.pfx
#   certificatePassword: ${CSC_KEY_PASSWORD}
